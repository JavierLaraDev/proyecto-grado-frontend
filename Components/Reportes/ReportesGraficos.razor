@inject IJSRuntime JS

<div class="charts-grid">

    <div class="chart-card">
        <h3>Ganancias</h3>
        <canvas id="gananciasChart"></canvas>
    </div>

    <div class="chart-card">
        <h3>Estado de Pedidos</h3>
        <canvas id="estadoPedidosChart"></canvas>
    </div>

</div>

@code {
    [Parameter] public int PedidosPendientes { get; set; }
    [Parameter] public int PedidosProceso { get; set; }
    [Parameter] public int PedidosEnviados { get; set; }
    [Parameter] public int PedidosEntregados { get; set; }
    [Parameter] public int PedidosCancelados { get; set; }

    private bool chartsRendered = false;

    private string[] meses = { "Ene", "Feb", "Mar", "Abr", "May", "Jun" };
    private double[] ganancias = { 1200, 1800, 1500, 2200, 2600, 3100 };

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        // 🔥 Dibujar SOLO cuando ya hay datos
        if (!chartsRendered &&
            (PedidosPendientes +
             PedidosProceso +
             PedidosEnviados +
             PedidosEntregados +
             PedidosCancelados) > 0)
        {
            chartsRendered = true;

            await JS.InvokeVoidAsync(
                "crearEstadoPedidos",
                PedidosPendientes,
                PedidosProceso,
                PedidosEnviados,
                PedidosEntregados,
                PedidosCancelados
            );

            await JS.InvokeVoidAsync(
                "crearGananciasChart",
                meses,
                ganancias
            );
        }
    }
}
